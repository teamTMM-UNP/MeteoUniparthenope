#!/bin/bash
set -e

echo "App Store Submission"

appName=$1  # QSF
bundleId=$2 # org.nativescript.examples
appId=$3    # 1046772499

echo "Copying the workspace package locally ..."
cp /tns-dist/tools/workspace/master/workspace.tgz .

echo "Installing the workspace package ..."
npm i workspace.tgz

echo "Submitting the app to the App Store ..."
node_modules/workspace/index.js ios-submit \
--ipa out/$appName.ipa \
--app-id CHSQ3M3P37.bundleId \
--apple-id appId \
--certificate "iPhone Distribution: Telerik A D" \
--mobile-provision /tns-dist/tools/OrgNativeScriptDistribution.mobileprovision \
--username nsbuilduser@telerik.com \
--password Cu\$dG2Xjkw
